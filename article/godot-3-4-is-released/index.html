<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="Godot Engine">
	<meta name="description" content="Godot 3.4 is finally released with a number of major new features and a focus on backporting UX improvements from the in-development 4.0 release. This new release adds portal occlusion culling, a revamped UI theme editor, glTF scene export, an animation RESET track, large files support, a lot of physics improvements and fixes, and more!">
	<meta name="theme-color" content="#3d8fcc">
	<meta property="og:site_name" content="Godot Engine">
	<meta property="og:url" content="https://godotengine.org/article/godot-3-4-is-released/">
	<meta name="twitter:site" content="@godotengine">

	<meta property="og:title" content="Godot 3.4 is released with major features and UX polish">
	<meta property="og:description" content="Godot 3.4 is finally released with a number of major new features and a focus on backporting UX improvements from the in-development 4.0 release. This new release adds portal occlusion culling, a revamped UI theme editor, glTF scene export, an animation RESET track, large files support, a lot of physics improvements and fixes, and more!">
	<meta property="og:image" content="https://godotengine.org/storage/app/uploads/public/618/6bb/7b3/6186bb7b3cb36127140644.jpg">
	<meta property="og:type" content="article">
	<meta name="twitter:card" content="summary_large_image">
	<title>Godot 3.4 is released with major features and UX polish</title>

	<link rel="alternate" type="application/rss+xml" title="Godot News" href="/rss.xml">
	<link rel="icon" href="/assets/favicon.png" sizes="any">
	<link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
	<link rel="stylesheet" href="/assets/css/main.css?112">
	<link rel="stylesheet" href="/assets/css/tobii.min.css">
	<link rel="preload" as="font" href="/assets/fonts/Montserrat-Bold.woff2" crossorigin>
	<link rel="preload" as="font" href="/assets/fonts/Montserrat-ExtraBold.woff2" crossorigin>
	<link rel="me" href="https://mastodon.gamedev.place/@godotengine">
</head>

<body>
	<input type="checkbox" id="nav_toggle_cb">
<header>
	<div class="container flex align-center">
		<div id="nav_head">
			<a href="/" id="logo-link">
				<img class="nav-logo" src="/assets/logo.svg" width="136" height="48" alt="Godot Engine">
				<img class="nav-logo dark-logo" src="/assets/logo_dark.svg" width="136" height="48" alt="Godot Engine">
			</a>
			<label for="nav_toggle_cb" id="nav_toggle_btn">
				<img src="/assets/icons/hamburger.svg" width="24" height="24" alt="Main menu">
			</label>
		</div>

		<nav id="nav">
			<ul class="left">
				<li><a href="/features/">Features</a></li>
				<li class="only-on-mobile"><a href="/showcase/">Showcase</a></li>
				<li><a href="/blog/">Blog</a></li>
				<li><a href="/community/">Community</a></li>
				<li><a href="/contact/">About</a></li>
				<li><a href="https://godotengine.org/asset-library/asset">Assets</a></li>
			</ul>

			<ul class="right">
				<li><a href="/download/windows/" class="set-os-download-url">Download</a></li>
				<li><a href="https://docs.godotengine.org">Docs</a></li>
				<li><a href="https://docs.godotengine.org/en/stable/community/contributing/index.html">Contribute</a></li>
				
				<li class="fund"><a href="https://fund.godotengine.org">❤&#xFE0E; Donate</a></li>
			</ul>
		</nav>
	</div>
</header>

<main>


<style>
	body {
		background-color: var(--background-color);
	}

	h1 {
		margin-bottom: 8px;
		margin-top: 32px;
	}

	:not(pre)>code {
		background: var(--code-background-color);
		padding: 1px 4px;
		font-size: 0.95em;
		border-radius: 3px;
	}

	pre {
		background: var(--codeblock-background-color);
		color: var(--codeblock-color);
	}

	pre code {
		display: block;
		overflow-x: auto;
		padding: .5em;
	}

	.date-big {
		line-height: 2;
		margin-left: 32px;
	}

	article {
		background-color: var(--base-color);
		box-shadow: 0px 3px 2px 0px rgba(0, 0, 0, 0.15);
	}

	figure {
		margin: 0;
	}

	figure img {
		margin: 0;
	}

	article img,
	article video {
		max-width: 100%;
		height: auto;
		display: block;
		margin: auto;
		margin-top: 16px;
		margin-bottom: 16px;
	}

	article h1 {
		margin-top: 64px;
	}

	article h2,
	article h3,
	article h4 {
		margin-top: 42px;
	}

	.article-info {
		display: flex;
		flex-direction: column;
		gap: 8px;
	}

	.article-metadata {
		display: flex;
		gap: 24px;
		align-items: center;
		font-family: var(--header-font-family);
		margin-bottom: 12px;
	}

	@media (max-width: 900px) {
		.article-metadata {
			flex-direction: column;
			align-items: flex-start;
			gap: 16px;
		}
	}

	.article-author {
		color: var(--base-color-text-subtitle-date);
		font-weight: 700;
		font-size: 18px;
		flex-grow: 1;
		display: flex;
		gap: 12px;
		align-items: center;
	}

	.article-author .avatar {
		border-radius: 100%;
		margin: 0;
	}

	.article-author .by {
		color: var(--base-color-text-subtitle);
	}

	.article-metadata .date {
		color: var(--base-color-text-subtitle-date);
	}

	.article-metadata .date.post-recent-highlight {
		color: var(--post-recent-highlight-color);
		opacity: 0.8;
	}

	.article-metadata .date.post-recent-highlight::after {
		font-size: 80%;
		content: "NEW";
		border: 2px solid var(--post-recent-highlight-color);
		padding: 2px 3px;
		margin-left: 8px;
	}

	.tag.active {
		filter: saturate(0.75);
	}

	@media screen and (min-width: 900px) {
		article .content {
			width: 70%;
			margin: auto;
		}
	}

	@media (max-width: 900px) {
		body {
			background-color: var(--base-color);
		}

		article {
			background-color: transparent;
			box-shadow: none;
		}

		article img:first-child,
		article video:first-child {
			max-width: 100%;
		}
	}
</style>

<link rel="stylesheet" href="/assets/css/highlight.obsidian.min.css">

<div class="container">
	<article class="padded">
		<div class="content article-container">
			<figure class="article-cover">
				

				<img src="/storage/app/uploads/public/618/6bb/7b3/6186bb7b3cb36127140644.jpg" title=""
					alt=" " class="rounded-lg"
					style="width: 100%; height: auto; background-color: transparent;" />
			</figure>

			<div class="article-info">
				<h1>
					Godot 3.4 is released with major features and UX polish
				</h1>
				<div class="article-metadata">
					<div class="article-author">
						<span>By: </span>
						
						
							<img class="avatar" width="25" height="25" src="/assets/images/authors/akien.webp" alt="Rémi Verschelde" loading="lazy">
						
						<span class="by">Rémi Verschelde</span>
					</div>
					<span class="date" data-post-date="2021-11-06 17:36:16 +0000">  6 November 2021</span>
				</div>

				<div class="tags">
					
					<a href="/blog/release">
						<div class="tag active">Release</div>
					</a>
					
				</div>
			</div>

			




			<div class="article-body">
				<p>All Godot contributors are delighted to release our latest milestone today, <strong>Godot 3.4</strong>, after more than 6 months of development!</p>

<p>While most development focus is on our upcoming Godot 4.0 release, many contributors and users want a robust and mature 3.x branch to develop and publish their games <em>today</em>, so it’s important for us to keep giving Godot 3 users an improved gamedev experience. As such, most of the focus was on implementing missing features or bugfixes which are critical for publishing 2D and 3D games with Godot 3, and on making the existing features more optimized and reliable.</p>

<p><strong>Godot 3.4 is compatible with Godot 3.3.x projects and is a recommended upgrade for all 3.3.x users.</strong></p>

<h2 id="download"><a href="/download">Download</a></h2>

<p><a href="/download"><strong>Download Godot 3.4 now</strong></a> and read on to learn more about the <a href="#features">many new features</a> in this update.</p>

<p>You can try it live with the <a href="https://editor.godotengine.org/releases/3.4.stable/"><strong>Web Editor</strong></a> too!</p>

<h2 id="supporting-the-project">Supporting the project</h2>

<p>Godot is a <strong>not-for-profit organization</strong> dedicated to providing the world with the best possible free and open source game technology. Donations and corporate grants play a vital role in enabling us to develop Godot at this sustained pace, since they are our only source of income, and are used 100% to pay developers to work on the engine. Thanks to all of you patrons from the bottom of our hearts!</p>

<p>If you use and enjoy Godot, plan to use it, or want support the cause of having a mature, high quality free and open source game engine, then please consider <a href="https://patreon.com/godotengine"><strong>becoming our patron</strong></a>. If you represent a company and want to let our vast community know that you support our cause, then please consider <a href="https://godotengine.org/donate">becoming our sponsor</a>. Additional funding will enable us to hire more core developers to work full-time on the engine, and thus further improve its development pace and stability.</p>

<p><a id="features"></a></p>
<h2 id="features">Features</h2>

<p>A video is worth a thousand words, and thanks to GDQuest, we have one that gives a great overview of the main highlights of Godot 3.4:</p>

<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/AaNMGVaJ--g" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<p>There have been thousands of changes, big and small, so listing everything would be impossible. You can however consult the <a href="https://github.com/godotengine/godot/blob/3.4-stable/CHANGELOG.md#34---2021-11-05"><strong>detailed changelog</strong></a>, where we attempted to list most relevant changes, separated by category: <a href="https://github.com/godotengine/godot/blob/3.4-stable/CHANGELOG.md#added">additions</a>, <a href="https://github.com/godotengine/godot/blob/3.4-stable/CHANGELOG.md#changed">changes</a>, <a href="https://github.com/godotengine/godot/blob/3.4-stable/CHANGELOG.md#removed">removals</a>, and <a href="https://github.com/godotengine/godot/blob/3.4-stable/CHANGELOG.md#fixed">fixes</a>. Note that this is a changelog between 3.3-stable and 3.4-stable, therefore it also includes some of the fixes already made available in intermediate 3.3.x maintenance releases.</p>

<p>In the rest of this post, we aim to give a broad overview of the most noteworthy features and changes in Godot 3.4. You can read in order, or use the index below to jump to your areas of interest.</p>

<p><a href="#core"><strong>Core:</strong></a></p>

<ul>
  <li><a href="#release-object-validity">Promote object validity checks to release builds</a></li>
  <li><a href="#large-files">Large files support (&gt; 2.0 GiB)</a></li>
  <li><a href="#delta-smoothing">Frame delta smoothing</a></li>
  <li><a href="#input">Improved input handling</a></li>
  <li><a href="#crypto">Crypto: AES and HMAC contexts</a></li>
</ul>

<p><a href="#rendering"><strong>Rendering:</strong></a></p>

<ul>
  <li><a href="#portal-occlusion-culling">Portal occlusion culling</a></li>
  <li><a href="#aces-fitted-tonemapping">ACES Fitted tonemapper</a></li>
  <li><a href="#particles-ring-emitter">Ring emitter for 3D particles</a></li>
  <li><a href="#shader-language">Shader language features</a></li>
  <li><a href="#more-rendering">More rendering improvements</a></li>
</ul>

<p><a href="#platforms"><strong>Platforms:</strong></a></p>

<ul>
  <li><a href="#android">Android: Scoped storage, Play Asset Delivery, input responsiveness</a></li>
  <li><a href="#html5">HTML5: PWA, Godot/JavaScript interface, AudioWorklet</a></li>
  <li><a href="#macos">macOS: Mono universal build, GDNative Framework, notarization</a></li>
</ul>

<p><a href="#physics"><strong>Physics:</strong></a></p>

<ul>
  <li><a href="#kinematic-body">KinematicBody improvements in 2D and 3D</a></li>
  <li><a href="#convex-hull-generation">Faster and more reliable convex hull generation</a></li>
  <li><a href="#collision-layer-grid">Revamped collision layer grid in the inspector</a></li>
  <li><a href="#bvh-physics-2d">Dynamic BVH for Godot Physics 2D</a></li>
  <li><a href="#godot-physics-3d">Improvements and new features in Godot Physics 3D</a></li>
</ul>

<p><a href="#assets"><strong>Assets pipeline:</strong></a></p>

<ul>
  <li><a href="#gltf-exporter">Export 3D scenes as glTF</a></li>
  <li><a href="#lossless-webp">Lossless WebP encoding</a></li>
</ul>

<p><a href="#editor"><strong>Editor:</strong></a></p>

<ul>
  <li><a href="#theme-editor">Revamped UI theme editor</a></li>
  <li><a href="#localized-classref">Localized class reference</a></li>
  <li><a href="#editor-usability">General usability improvements</a></li>
</ul>

<p><a href="#other-areas"><strong>Other areas:</strong></a></p>

<ul>
  <li><a href="#animation-reset">Animation “reset” track</a></li>
  <li><a href="#viewport-scale">2D viewport scale factor</a></li>
  <li><a href="#csgpolygon">Improvements and fixes to path mode for CSGPolygon</a></li>
</ul>

<p>This is not an exhaustive list of changes in this release, so we advise interested users to also dive into the <a href="https://github.com/godotengine/godot/blob/3.4-stable/CHANGELOG.md#34---2021-10-05"><strong>detailed changelog</strong></a> to know more.</p>

<hr />

<p><a id="core"></a></p>
<h3 id="core">Core</h3>

<p><a id="release-object-validity"></a></p>
<h4 id="promote-object-validity-checks-to-release-builds">Promote object validity checks to release builds</h4>

<p>Most Godot users have run into situations where an <code class="language-plaintext highlighter-rouge">Object</code> instance gets deleted (e.g. by calling <code class="language-plaintext highlighter-rouge">queue_free()</code>) but is still accessed somewhere else in a script. Such use-after-free access needs to be guarded with <code class="language-plaintext highlighter-rouge">is_instance_valid(obj)</code>, but this has been surprisingly difficult to get right due to a number of bugs and inconsistencies between <em>debug</em> and <em>release</em> builds.</p>

<p>Pedro J. Estébanez (<a href="https://github.com/RandomShaper">RandomShaper</a>) has become an expert on this topic and made a number of improvements included in <a href="/article/maintenance-release-godot-3-2-2#dangling-variant">Godot 3.2.2</a> and <a href="/article/godot-3-3-has-arrived#deleted-objects-debug">Godot 3.3</a>. With this new change, the checks which were already performed in <em>debug</em> builds have been <a href="https://github.com/godotengine/godot/pull/51796">promoted to also run in <em>release</em> builds</a>, solving a discrepancy which was the source of much trouble for Godot users. This has a theoretical performance cost for release builds, but it was found not to be significant.</p>

<p><a id="large-files"></a></p>
<h4 id="large-files-support--20-gib">Large files support (&gt; 2.0 GiB)</h4>

<p>The <code class="language-plaintext highlighter-rouge">File</code> API can now manipulate files larger than 2.0 GiB, including PCK files, which used to be a limiting factor for bigger games.
Everything has been refactored to used unsigned 64-bit integers, which means that Godot now supports loading files of up to 8.4 million TiB… which should be sufficient for the foreseeable future.</p>

<p>Pedro started this work in <a href="https://github.com/godotengine/godot/pull/27247">2019</a>, and Rémi Verschelde (<a href="https://github.com/akien-mga">Akien</a>) <a href="https://github.com/godotengine/godot/pull/47254">updated it</a> for the 3.4 release to match the core contributors’ consensus.</p>

<p><a id="delta-smoothing"></a></p>
<h4 id="frame-delta-smoothing">Frame delta smoothing</h4>

<p>Currently, frame deltas are measured by sampling the OS clock, which can be subject to considerable random variations. Even when frames are being consistently displayed precisely at the vsync rate, these input timings can throw off object positions. <a href="https://github.com/lawnjelly">lawnjelly</a> added an option for <a href="https://github.com/godotengine/godot/pull/48390">frame delta smoothing</a> that detects when Godot is hitting vsync consistently, and replaces the sampled input time with the fixed vsync delta. This can significantly improve the fluidity of motion and give smoother gameplay. This option is enabled by default, but can be turned off if you experience timing-related issues with your projects.</p>

<p>Another option was added to <a href="https://github.com/godotengine/godot/pull/48555">sync frame delta after draw</a>, which is disabled by default. It may lead to more consistent deltas and further reduce frame stutters for some games.</p>

<p>Manuel Moos (<a href="https://github.com/zmanuel">zmanuel</a>) also implemented a fix for occasional <a href="https://github.com/godotengine/godot/pull/35617">negative frame deltas</a> due to getting out of sync with the OS clock.</p>

<p><a id="input"></a></p>
<h4 id="improved-input-handling">Improved input handling</h4>

<p><a href="https://github.com/bruvzg">bruvzg</a> added support for <a href="https://github.com/godotengine/godot/pull/46764">physical keys</a> in the keyboard InputEvents. Physical keys are a way to map the position of a key based on a standard US QWERTY keyboard layout, so that the same location can be used even when the player’s keyboard layout is different. For example mapping movements keys to WASD using physical keys will automatically remap them to ZQSD on a French AZERTY keyboard (where W and Z, and Q and A, are swapped). This makes it easier to support multiple keyboard layouts.</p>

<p>To simplify some of the most common constructs in input handling code for character movement, Aaron Franke (<a href="https://github.com/aaronfranke">aaronfranke</a>) added <a href="https://github.com/godotengine/godot/pull/50788">two new helper methods</a>: <code class="language-plaintext highlighter-rouge">Input.get_axis()</code> and <code class="language-plaintext highlighter-rouge">Input.get_vector()</code>. These methods allow simplifying code like this:</p>

<div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="n">walk</span> <span class="o">=</span> <span class="n">WALK_FORCE</span> <span class="o">*</span> <span class="p">(</span><span class="n">Input</span><span class="o">.</span><span class="n">get_action_strength</span><span class="p">(</span><span class="s2">"move_right"</span><span class="p">)</span> <span class="o">-</span> <span class="n">Input</span><span class="o">.</span><span class="n">get_action_strength</span><span class="p">(</span><span class="s2">"move_left"</span><span class="p">))</span>

<span class="k">var</span> <span class="n">velocity</span> <span class="o">=</span> <span class="kt">Vector2</span><span class="p">(</span>
    <span class="n">Input</span><span class="o">.</span><span class="n">get_action_strength</span><span class="p">(</span><span class="s2">"move_right"</span><span class="p">)</span> <span class="o">-</span> <span class="n">Input</span><span class="o">.</span><span class="n">get_action_strength</span><span class="p">(</span><span class="s2">"move_left"</span><span class="p">),</span>
    <span class="n">Input</span><span class="o">.</span><span class="n">get_action_strength</span><span class="p">(</span><span class="s2">"move_back"</span><span class="p">)</span> <span class="o">-</span> <span class="n">Input</span><span class="o">.</span><span class="n">get_action_strength</span><span class="p">(</span><span class="s2">"move_forward"</span><span class="p">)</span>
<span class="p">)</span><span class="o">.</span><span class="n">normalized</span><span class="p">()</span>
</code></pre></div></div>

<p>To this:</p>

<div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">var</span> <span class="n">walk</span> <span class="o">=</span> <span class="n">WALK_FORCE</span> <span class="o">*</span> <span class="n">Input</span><span class="o">.</span><span class="n">get_axis</span><span class="p">(</span><span class="s2">"move_left"</span><span class="p">,</span> <span class="s2">"move_right"</span><span class="p">)</span>

<span class="k">var</span> <span class="n">velocity</span> <span class="o">=</span> <span class="n">Input</span><span class="o">.</span><span class="n">get_vector</span><span class="p">(</span><span class="s2">"move_left"</span><span class="p">,</span> <span class="s2">"move_right"</span><span class="p">,</span> <span class="s2">"move_forward"</span><span class="p">,</span> <span class="s2">"move_back"</span><span class="p">)</span>
</code></pre></div></div>

<p>For more information, read the <a href="https://docs.godotengine.org/en/stable/tutorials/inputs/controllers_gamepads_joysticks.html#which-input-singleton-method-should-i-use">“Which Input singleton method should I use?”</a> section of the controller input article.</p>

<p><a id="crypto"></a></p>
<h4 id="crypto-aes-and-hmac-contexts">Crypto: AES and HMAC contexts</h4>

<p>Fabio Alessandrelli (<a href="https://github.com/Faless">fales</a>) backported a number of <a href="https://github.com/godotengine/godot/pull/48144">cryptographic features</a> for the 3.4 release, adding an <code class="language-plaintext highlighter-rouge">AESContext</code> to provide a scripting interface to AES-ECB and AES-CBC encryption/decryption methods. Godot can now save and load public keys, sign and verify a hash with a RSA key, and encrypt and decrypt RSA keys.</p>

<p>Jon Bonazza (<a href="https://github.com/jonbonazza">jonbonazza</a>) and <a href="https://github.com/tavurth">tavurth</a> respectively implemented and <a href="https://github.com/godotengine/godot/pull/48869">backported HMAC support</a> in the crypto API via a new <code class="language-plaintext highlighter-rouge">HMACContext</code>. This can be used as an authentication method notibly to interact with services such as GameAnalytics.</p>

<p><a id="rendering"></a></p>
<h3 id="rendering">Rendering</h3>

<p><a id="portal-occlusion-culling"></a></p>
<h4 id="portal-occlusion-culling">Portal occlusion culling</h4>

<p>Up till now a significant missing feature in the renderer has been the ability to cull (prevent rendering) objects that are within the camera view, but occluded by another object (for instance a wall). Although raster (pixel based) occlusion culling will not be available until Godot 4, some geometrical occlusion methods are being added to Godot 3.</p>

<p>Thanks to lawnjelly, Godot 3.4 introduces <a href="https://github.com/godotengine/godot/pull/46130">portal occlusion culling</a>, which is a tried and tested occlusion solution that has been used in many games, but does require some manual setup of the scene. As well as performing occlusion culling it also provides a solution for throttling AI and processing based on proximity to the viewer.</p>

<video autoplay="" loop="">
  <source src="/storage/app/media/3.4/portal-occlusion.mp4" type="video/mp4" />
</video>

<p>In addition the ability to add simple geometrical occluders to scenes is being rolled out, starting with spherical occluders which are available in 3.4.</p>

<p><a id="aces-fitted-tonemapping"></a></p>
<h4 id="aces-fitted-tonemapper">ACES Fitted tonemapper</h4>

<p>Godot 3.4 adds a new <a href="https://github.com/godotengine/godot/pull/52477">ACES Fitted tonemapper option</a> contributed by Endri Lauson (<a href="https://github.com/Lauson1ex">Lauson1ex</a>) that allows scenes to look more realistic, such as by correctly handling the contrast of bright objects. You can try it out in the <a href="https://godotengine.org/asset-library/asset/678">Third Person Shooter (TPS) demo</a> which has been updated to use the ACES Fitted tonemapper.</p>

<video autoplay="" loop="">
  <source src="/storage/app/media/3.4/aces-fitted.mp4" type="video/mp4" />
</video>

<p><a id="particles-ring-emitter"></a></p>
<h4 id="ring-emitter-for-3d-particles">Ring emitter for 3D particles</h4>

<p>Ilaria Cislaghi (<a href="https://github.com/QbieShay">QbieShay</a>) implemented a new <a href="https://github.com/godotengine/godot/pull/47801">ring emitter for 3D particles</a> which can emit particles on a ring or hollow cylinder with configurable radii and height.</p>

<video autoplay="" loop="">
  <source src="/storage/app/media/3.4/ring-emitter.mp4" type="video/mp4" />
</video>

<p><a id="shader-language"></a></p>
<h4 id="shader-language-features">Shader language features</h4>

<p>Our shader language maintainer Yuri Roubinsky (<a href="https://github.com/Chaosus">Chaosus</a>) is busy <a href="/article/improvements-shaders-visual-shaders-godot-4">doing magic on the development branch</a> for Godot 4.0, but with the help of <a href="https://github.com/lyuma">lyuma</a> some of the most-requested features could be backported to Godot 3.4.</p>

<p>This includes support for <a href="https://github.com/godotengine/godot/pull/48075">structs and fragment-to-light varyings</a>, as well as <a href="https://github.com/godotengine/godot/pull/50889">global const arrays</a>. The <code class="language-plaintext highlighter-rouge">TIME</code> built-in uniform was also made <a href="https://github.com/godotengine/godot/pull/49509">available in custom functions</a> by default.</p>

<p><img src="https://user-images.githubusercontent.com/3036176/121683895-aaa1d500-cac6-11eb-952a-e3487635abc5.gif" alt="Using TIME uniform in a custom function" /></p>

<p><a id="more-rendering"></a></p>
<h4 id="more-rendering-improvements">More rendering improvements</h4>

<p>While there’s so much rendering work being done for Godot 4.0, the 3.4 release got its fair share of improvements and bug fixes, thanks to the dedication of many contributors!</p>

<p>Some examples are:</p>

<ul>
  <li>Octahedral map normal/tangent attribute compression (<a href="https://github.com/godotengine/godot/pull/46800">GH-46800</a>).</li>
  <li>Added basic support for CPU blendshapes in GLES2 (<a href="https://github.com/godotengine/godot/pull/48480">GH-48480</a>, <a href="https://github.com/godotengine/godot/pull/51363">GH-51363</a>).</li>
  <li>Fix draw order of transparent materials with multiple directional lights in GLES3 (<a href="https://github.com/godotengine/godot/pull/47129">GH-47129</a>).</li>
  <li>Fixes depth sorting of meshes with transparent textures (<a href="https://github.com/godotengine/godot/pull/50721">GH-50721</a>).</li>
  <li>Add new 3D inverse-squared point light attenuation as an option (<a href="https://github.com/godotengine/godot/pull/52918">GH-52918</a>).</li>
  <li>And more! Search “rendering” <a href="https://github.com/godotengine/godot/blob/3.4-stable/CHANGELOG.md#34---2021-10-05">in the changelog</a>.</li>
</ul>

<p><a id="platforms"></a></p>
<h3 id="platforms">Platforms</h3>

<p><a id="android"></a></p>
<h4 id="android-scoped-storage-play-asset-delivery-input-responsiveness">Android: Scoped storage, Play Asset Delivery, input responsiveness</h4>

<p>Fredia Huya-Kouadio (<a href="https://github.com/m4gr3d">m4gr3d</a>) implemented initial support for the new <a href="https://github.com/godotengine/godot/pull/50359">Android scoped storage API</a>, enabling us to target API level 30 as required by Google Play. This doesn’t cover all features yet for external storage access, which are <a href="https://github.com/godotengine/godot/pull/51815">being worked on for Godot 3.5</a>.</p>

<p>Initial support was also implemented for Android’s <a href="https://github.com/godotengine/godot/pull/52526">Play Asset Delivery</a>, which replaces APK’s expansion files (OBBs) for Android App Bundle (AAB) binaries.</p>

<p>Pedro added an option for <a href="/article/agile-input-processing-is-here-for-smoother-gameplay">agile input processing</a>, which can help increase responsiveness for input on lower-end mobile devices, so you can keep games playable even if the framerate isn’t at a steady 60 FPS.</p>

<p><a id="html5"></a></p>
<h4 id="html5-pwa-godotjavascript-interface-audioworklet">HTML5: PWA, Godot/JavaScript interface, AudioWorklet</h4>

<p>Our HTML5 platform maintainer Fabio kept doing a lot of work for this platform in the 3.4 development branch, which brings us a number of new features and improvements.</p>

<p>Godot Web projects can now optionally include support for being <a href="https://godotengine.org/article/godot-web-progress-report-8">installed as Progressive Web Apps</a>.</p>

<p>A new <code class="language-plaintext highlighter-rouge">JavaScriptObject</code> was exposed to provide an <a href="https://godotengine.org/article/godot-web-progress-report-9">interface between Godot and JavaScript</a>, enabling you to call JavaScript methods directly from your Godot scripts. This makes it much easier to use JavaScript APIs in your Web projects.</p>

<div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">extends</span> <span class="n">Node</span>

<span class="k">func</span> <span class="nf">_ready</span><span class="p">():</span>
    <span class="c1"># Retrieve the `window.console` object.</span>
    <span class="k">var</span> <span class="n">console</span> <span class="o">=</span> <span class="n">JavaScript</span><span class="o">.</span><span class="n">get_interface</span><span class="p">(</span><span class="s2">"console"</span><span class="p">)</span>
    <span class="c1"># Call the `window.console.log()` method.</span>
    <span class="n">console</span><span class="o">.</span><span class="nb">log</span><span class="p">(</span><span class="s2">"test"</span><span class="p">)</span>
</code></pre></div></div>

<p>AudioWorklet was implemented for multi-threaded builds in Godot 3.3, solving issues with audio playback. But not all browsers or Web games platforms provide support for the necessary multi-threading APIs yet, so for single-threaded exports, <a href="https://github.com/godotengine/godot/pull/52650">AudioWorklet was also implemented as a non-threaded option</a>. Performance is not the best, but it’s better than stuttering audio as users might experience on Chrome due to their deprecation of the previous standard <code class="language-plaintext highlighter-rouge">ScriptProcessorNode</code> approach.</p>

<p><a id="macos"></a></p>
<h4 id="macos-mono-universal-build-gdnative-framework-notarization">macOS: Mono universal build, GDNative Framework, notarization</h4>

<p>Thanks to an update of our Mono version to 6.12.0.158 (Preview), macOS builds can now target Apple Silicon too, so the macOS Mono builds are now also universal builds (both <code class="language-plaintext highlighter-rouge">x86_64</code> and <code class="language-plaintext highlighter-rouge">arm64</code> support).</p>

<p>bruvzg also added support for using <a href="https://github.com/godotengine/godot/pull/46860">macOS <code class="language-plaintext highlighter-rouge">.frameworks</code> libraries with GDNative</a>, and in-editor integration for the <a href="https://github.com/godotengine/godot/pull/49276">Apple notarization process</a> (only available when exporting <strong>to</strong> macOS <strong>from</strong> macOS).</p>

<p><img src="https://user-images.githubusercontent.com/7645683/84271035-3c81a580-ab34-11ea-934f-eda54037f45e.png" alt="Notarization settings" /></p>

<p><a id="physics"></a></p>
<h3 id="physics">Physics</h3>

<p>Thanks to the work of multiple dedicated contributors, many improvements and fixes have been done in both 2D and 3D physics. It can’t be all detailed here, but here’s a list of the ones that have the most impact on usability and performance.</p>

<p><a id="kinematic-body"></a></p>
<h4 id="kinematicbody-improvements-in-2d-and-3d">KinematicBody improvements in 2D and 3D</h4>

<p>While character controllers are being reworked for Godot 4.0 to be more reliable and much easier to use out-of-the-box, some major improvements and fixes have been also added to the 3.4 release:</p>
<ul>
  <li>Better handling of moving platforms thanks to <a href="https://github.com/fabriceci">fabriceci</a>: <a href="https://github.com/godotengine/godot/pull/50166">GH-50166</a>.</li>
  <li>Improved RayShape stability in Godot Physics 2D/3D: <a href="https://github.com/godotengine/godot/pull/53453">GH-53453</a>.</li>
  <li>Various improvements for floor stability in Godot Physics 2D/3D.</li>
</ul>

<p><a id="convex-hull-generation"></a></p>
<h4 id="faster-and-more-reliable-convex-hull-generation">Faster and more reliable convex hull generation</h4>

<p>Morris Arroad (<a href="https://github.com/mortarroad">mortarroad</a>) has worked on using a more reliable algorithm from Bullet to generate physics convex hulls from meshes. It’s now several times faster in complex cases, and has generally better results: <a href="https://github.com/godotengine/godot/pull/48533">GH-48533</a>.</p>

<p>On top of that, thanks to the common work of Camille Mohr-Daurat (<a href="https://github.com/pouleyKetchoupp">pouleyKetchoupp</a>), <a href="https://github.com/jitspoe">jitspoe</a> and <a href="https://github.com/lawnjelly">lawnjelly</a> there’s now an option to generate a simplified convex hull from complex meshes, in order to make a convex hull that’s better for performance, at the cost of losing a bit of accuracy.</p>

<p>Example original mesh (40K vertices):
<img src="https://user-images.githubusercontent.com/1075032/124838784-66c2b400-df3c-11eb-9d29-2a920a14f9bb.PNG" alt="Original mesh (40K verticies)" /></p>

<p>Simplified convex hull of that mesh (56 vertices):
<img src="https://user-images.githubusercontent.com/1075032/124838823-79d58400-df3c-11eb-8515-fe8775930353.PNG" alt="Simplified convex hull (56 vertices)" /></p>

<p><a id="collision-layer-grid"></a></p>
<h4 id="revamped-collision-layer-grid-in-the-inspector">Revamped collision layer grid in the inspector</h4>

<p>The <a href="https://github.com/godotengine/godot/pull/51040">layer grid widget</a> has been improved to be more readable and support up to 32 collision layers in physics.</p>

<p><img src="https://user-images.githubusercontent.com/1075032/127698216-a7155488-52b6-45bf-8ff6-9495e8b0d4e1.png" alt="Layer grid widget with 32 layers" /></p>

<p><a id="bvh-physics-2d"></a></p>
<h4 id="dynamic-bvh-for-godot-physics-2d">Dynamic BVH for Godot Physics 2D</h4>

<p>Based on the most part on the work <a href="https://github.com/lawnjelly">lawnjelly</a> already did <a href="https://godotengine.org/article/godot-3-3-has-arrived#dynamic-bvh">for 3D</a>, <a href="https://github.com/pouleyKetchoupp">pouleyKetchoupp</a> has added support for using a dynamic BVH for the broadphase in 2D physics: <a href="https://github.com/godotengine/godot/pull/48314">GH-48314</a>.</p>

<p>Like the 3D version, it generally has better performance and is more reliable, but it’s still possible to switch back to the old HashGrid in project settings if needed.</p>

<p><a id="godot-physics-3d"></a></p>
<h4 id="improvements-and-new-features-in-godot-physics-3d">Improvements and new features in Godot Physics 3D</h4>

<p>While Godot Physics 3D is being worked on to become the default physics engine in 4.0, new features and improvements are backported to 3.x when possible.</p>

<p>That includes:</p>
<ul>
  <li>Support for <a href="https://github.com/godotengine/godot/pull/47349">HeightMap shapes</a> with the same optimizations as in Bullet thanks to the work of Marc Gilleron (<a href="https://github.com/Zylann">Zylann</a>).</li>
  <li>Support for <a href="https://github.com/godotengine/godot/pull/49446">Sync to Physics</a>.</li>
  <li>Various fixes for RigidBody and KinematicBody.</li>
</ul>

<p><img src="/storage/app/media/godot-heightmap.gif" alt="HeightMap shape in the Godot Physics engine" /></p>

<p><a id="assets"></a></p>
<h3 id="assets-pipeline">Assets pipeline</h3>

<p><a id="gltf-exporter"></a></p>
<h4 id="export-3d-scenes-as-gltf">Export 3D scenes as glTF</h4>

<p>The glTF module authored by Ernest Lee (<a href="https://github.com/fire">fire</a> for Godot 4.0 was <a href="https://github.com/godotengine/godot/pull/49120">backported to the 3.x branch</a> by lyuma. The biggest feature this adds is the ability to export scenes as glTF. This means you can build a scene in Godot using your favorite tools such as CSG, and then bring all of the mesh data into other 3D applications such as Blender or other Godot versions.</p>

<p><a id="lossless-webp"></a></p>
<h4 id="lossless-webp-encoding">Lossless WebP encoding</h4>

<p>WebP is a new image format that can replace both JPEG and PNG. It has both lossy and lossless modes which are much more optimized than JPEG and PNG, it has a faster decompression time and a smaller file size compared to PNG. Godot already used WebP for lossy compression, and Godot 3.4 now <a href="https://github.com/godotengine/godot/pull/47835">defaults to using it for lossless texture compression</a> instead of PNGs, thanks to work from Morris Arroad (<a href="https://github.com/mortarroad">mortarroad</a>). The importer time might be slightly increased, but the imported file sizes and loading times are <a href="https://github.com/godotengine/godot/pull/47835#issuecomment-818573160">significantly reduced</a>.</p>

<p>For existing projects, you may want to delete the <code class="language-plaintext highlighter-rouge">res://.import</code> folder to force a reimport of all lossless compressed textures using WebP. PNG is still supported, and can be enforced as the default via an option.</p>

<p><a id="editor"></a></p>
<h3 id="editor">Editor</h3>

<p><a id="theme-editor"></a></p>
<h4 id="revamped-ui-theme-editor">Revamped UI theme editor</h4>

<p>Godot provides an extensive system for customizing the looks of UI nodes, but until this point the tools for that were lacking ease of use and kept some users away from a really cool feature. To address multiple concerns and suggestions Yuri Sizov (<a href="https://github.com/pycbouh">pycbouh</a>) worked on overhauling the editor tools for theming and skinning. The new theme editor aims to make it as straightforward as possible to adjust your control nodes. You have improve listing of available properties that can be easily overridden for your project. A control picker allows to visually select the node you want to customize right from the preview panel. You can have custom previews from the scenes that make sense for your project. Styleboxes of the same type can be edited together to save you time adjusting their margins and borders. And theming power users can enjoy a new item management dialog that gives a lot of granularity when doing bulk adjustments to Theme resources.</p>

<p>Take a look at the new theme editor in action in this GDQuest video:</p>

<iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/3AGGBZVVVTw" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen=""></iframe>

<p><a id="localized-classref"></a></p>
<h4 id="localized-class-reference">Localized class reference</h4>

<p>Rémi implemented support for localizing the in-editor class reference back in <a href="https://github.com/godotengine/godot/pull/37164">March 2020</a> for 4.0, and finally decided to <a href="https://github.com/godotengine/godot/pull/53511">backport the new feature</a> (and first round of <a href="https://hosted.weblate.org/projects/godot-engine/godot-class-reference/">community-authored translations</a>) for 3.4.</p>

<p>Godot 3.4 includes class reference translations for Chinese (Simplified) and Spanish with a high rate of completion. French, Japanese, and German also have translations included, but only for a subset of the API. Everyone is welcome to <a href="https://hosted.weblate.org/projects/godot-engine/godot-class-reference/">participate in the translation effort</a>, so that future releases can include more languages and more translated content.</p>

<p><img src="https://user-images.githubusercontent.com/4701338/136363092-1c43444d-388e-4f33-b44e-073490fce769.jpg" alt="Class reference localized in Chinese (Simplified)" /></p>

<p><a id="editor-usability"></a></p>
<h4 id="general-usability-improvements">General usability improvements</h4>

<p>The 3.4 release has a <em>huge</em> focus on editor usability. Those are changes which are for the most part independent of the big core, rendering and scripting changes in the 4.0 branch, and can therefore be backported relatively easily.
Here’s a short selection of some highlights:</p>

<ul>
  <li><a href="https://github.com/godotengine/godot/pull/37228">Use QuickOpen to load resources in the inspector</a></li>
  <li><a href="https://github.com/godotengine/godot/pull/51166">Rationalize property reversion</a></li>
  <li><a href="https://github.com/godotengine/godot/pull/50242">Allow to create a node at specific position</a></li>
  <li><a href="https://github.com/godotengine/godot/pull/50531">New export templates manager</a></li>
  <li><a href="https://github.com/godotengine/godot/pull/50528">Make several actions in the Inspector dock more obvious</a></li>
  <li><a href="https://github.com/godotengine/godot/pull/50597">Improve the 3D editor manipulation gizmo</a></li>
  <li><a href="https://github.com/godotengine/godot/pull/48572">Improve the animation bezier editor</a></li>
  <li>And more! Search “editor” <a href="https://github.com/godotengine/godot/blob/3.4-stable/CHANGELOG.md#34---2021-10-05">in the changelog</a>.</li>
</ul>

<p><a id="other-areas"></a></p>
<h3 id="other-areas">Other areas</h3>

<p><a id="animation-reset"></a></p>
<h4 id="animation-reset-track">Animation “reset” track</h4>

<p>One of the most common hurdles when using AnimationPlayer is that editing animations will permanently modify the state of your scene. To avoid this, users had to manually undo changes to all properties modified by the animation.</p>

<p>Now the resetting process can be automated, with the addition of a <a href="https://github.com/godotengine/godot/pull/44558">RESET animation feature</a> thanks to Pedro. The RESET animation can be automatically added to AnimationPlayer and whenever a new keyframe is inserted for the first time, its value will also be mirrored in the RESET track as a default value. Upon scene save, affected properties are automatically saved with their default values, so editing animation no longer affects what is saved in your scene.</p>

<video autoplay="" loop="">
  <source src="/storage/app/media/3.4/reset-animation.mp4" type="video/mp4" />
</video>

<p><a id="viewport-scale"></a></p>
<h4 id="2d-viewport-scale-factor">2D viewport scale factor</h4>

<p><a href="https://github.com/Ansraer">Ansraer</a> added a <a href="https://github.com/godotengine/godot/pull/52137">2D viewport scale factor</a> in the Project Settings, which can be used to make 2D elements larger or smaller, independently of the current stretch mode.</p>

<p><a id="csgpolygon"></a></p>
<h4 id="improvements-and-fixes-to-path-mode-for-csgpolygon">Improvements and fixes to path mode for CSGPolygon</h4>

<p>CSGPolygon has gotten a number of fixes and improvements in this release, notably thanks to <a href="https://jitspoe">jitspoe</a> who <a href="https://github.com/godotengine/godot/pull/52509">added properties</a> to configure angle simplification, UV distance, and path interval when using the Path mode.</p>

<video autoplay="" loop="">
  <source src="/storage/app/media/3.4/csgpolygon.mp4" type="video/mp4" />
</video>

<h2 id="and-many-more-changes">And many more changes!</h2>

<p>There’s <em>a lot</em> more that would be worth showcasing in this blog post, but it’s already fairly long and we’re eager to get it published :D</p>

<p>Godot 3.4 is ready to use now and we want you to have it without further ado.</p>

<p>We would like to take the opportunity to thank all of our amazing contributors for all the other great features merged since 3.3, and the hundreds of bugfixes and usability improvements done in this release. Even if not listed here, every contribution makes Godot better, and this release is truly the work of hundreds of individuals working together towards a common goal and passion.</p>

<p>For more details on other changes in Godot 3.4, please consult our <a href="https://github.com/godotengine/godot/blob/3.4-stable/CHANGELOG.md#34---2021-10-05">curated changelog</a>, as well as the raw changelog from Git (<a href="https://downloads.tuxfamily.org/godotengine/3.4/Godot_v3.4-stable_changelog_chrono.txt">chronological</a>, or sorted <a href="https://downloads.tuxfamily.org/godotengine/3.4/Godot_v3.4-stable_changelog_authors.txt">by authors</a>).</p>

<h2 id="reporting-issues">Reporting issues</h2>

<p>Godot is a complex piece of software and is not bug-free. Our contributors do their best to fix issues as they are being reported, but there’s a lot of surface to cover and you might encounter situations which we aren’t aware of yet, or couldn’t fix in time for this release. There will be 3.4.x maintenance releases focused on fixing bugs in coming weeks and months, so make sure to <a href="https://github.com/godotengine/godot/issues">report any issue you encounter on GitHub</a>, so that we can make sure to fix it for our future releases.</p>

<h2 id="giving-back">Giving back</h2>

<p>As a community effort, Godot relies on individual contributors to improve. In addition to becoming a <a href="https://patreon.com/godotengine">Patron</a>, please consider giving back by: writing high-quality bug reports, contributing to the code base, writing documentation, writing tutorials (for the docs or on your own space), and supporting others on the various <a href="https://docs.godotengine.org/en/latest/community/channels.html">community platforms</a> by answering questions and providing helpful tips.</p>

<p>Last but not least, making games with Godot and crediting the engine goes a long way to help raise its popularity, and thus the number of active contributors who make it better on a daily basis. Remember, we are all in this together and Godot requires community support in every area in order to thrive.</p>

<p><a href="/download">Now go and have fun with 3.4!</a></p>

			</div>
		</div>
	</article>
</div>

<link rel="stylesheet" href="/assets/css/anchor-link.css?1">
<link rel="stylesheet" href="/assets/css/article-cards.css?2">
<script src="/assets/js/anchor-link.js"></script>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		// Add icons to easily copy section links.
		window.applyAnchorLinks('.article-body');

		// Add lightbox elements in blog articles for Tobii.
		document.querySelectorAll('.article-cover img, .article-body img').forEach((articleImg) => {
			if (articleImg.classList.contains('lightbox-ignore')) {
				return;
			}

			const lightbox = document.createElement('a');
			lightbox.href = articleImg.src;
			lightbox.classList.add('lightbox');
			lightbox.dataset.group = 'article';
			articleImg.parentNode.appendChild(lightbox);
			lightbox.appendChild(articleImg);
		});
	});
</script>

</main>

<footer>
	<div class="container flex footer-container">
		<div id="copyright">
			<p>
				© 2007-2024 Juan Linietsky, Ariel Manzur and <a
					href="https://github.com/godotengine/godot/blob/master/AUTHORS.md" target="_blank"
					rel="noopener">contributors</a>.<br>
				Hosted by the <a href="https://godot.foundation/" target="_blank" rel="noopener">Godot Foundation</a>.<br>
				Website <a href="https://github.com/godotengine/godot-website" target="_blank" rel="noopener">source code on  GitHub</a>.
			</p>
		</div>
		<div id="sitemap">
			<ul class="sitemap-group">
				<li><strong>Get Godot</strong></li>
				<li><a href="/download/windows/" class="set-os-download-url">Download</a></li>
				<li><a href="/download/archive/">Release Archive</a></li>
				<li><a href="https://editor.godotengine.org/releases/latest/">Web Editor</a></li>
				<li>&nbsp;</li>
				<li><strong>Public Relations</strong></li>
				<li><a href="/blog/">Blog</a></li>
				<li><a href="/community/">Communities and Events</a></li>
				<li><a href="/press/">Press Kit</a></li>
			</ul>
			<ul class="sitemap-group">
				<li><strong>About Godot</strong></li>
				<li><a href="/features/">Features</a></li>
				<li><a href="/showcase/">Showcase</a></li>
				<li><a href="/education/">Education</a></li>
				<li><a href="/license/">License</a></li>
				<li><a href="/code-of-conduct/">Code of Conduct</a></li>
				<li><a href="/privacy-policy/">Privacy Policy</a></li>
				<li><a href="https://fund.godotengine.org">Donate</a></li>
			</ul>
			<ul class="sitemap-group">
				<li><strong>Project Team</strong></li>
				<li><a href="/governance/">Governance</a></li>
				<li><a href="/teams/">Teams</a></li>
				<li>&nbsp;</li>
				<li><strong>Extra Resources</strong></li>
				<li><a href="https://godotengine.org/asset-library/asset">Asset Library</a></li>
				<li><a href="https://docs.godotengine.org">Documentation</a></li>
				<li><a href="https://github.com/godotengine">Code Repository</a></li>
			</ul>
		</div>
		<div id="social" class="dark-desaturate">
			<h4 class="text-right"><a href="/contact/">Contact us</a></h4>
			<div class="flex justify-space-between" style="gap: 3px;">
				<a href="https://github.com/godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/github_logo.svg" width="32" height="32" alt="GitHub">
				</a>
				<a href="https://mastodon.gamedev.place/@godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/mastodon_logo.svg" width="32" height="32" alt="Mastodon">
				</a>
				<a href="https://twitter.com/godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/twitter_logo.svg" width="32" height="32" alt="Twitter">
				</a>
				<a href="https://www.facebook.com/groups/godotengine/" target="_blank" rel="noopener">
					<img src="/assets/footer/facebook_logo.svg" width="32" height="32" alt="Facebook">
				</a>
				<a href="https://www.reddit.com/r/godot" target="_blank" rel="noopener">
					<!-- Zero-width space in the `alt` text to prevent content blockers from blocking the icon -->
					<img src="/assets/footer/reddit_logo.svg" width="32" height="32" alt="Red​dit">
				</a>
				<a href="/rss.xml" target="_blank" rel="noopener">
					<!-- Icon is called `feed` instead of `rss` to prevent content blockers from blocking the icon -->
					<img src="/assets/footer/feed_logo.svg" width="32" height="32" alt="RSS feed">
				</a>
			</div>
		</div>
	</div>
</footer>

<script defer src="/assets/js/tobii.min.js"></script>
<script defer src="/assets/js/highlight.min.js?1"></script>
<script defer src="/assets/js/highlight.gdscript.min.js?1"></script>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		// This needs to be done on page load but also after page changes,
		// in case a code block appears in an article.
		document.querySelectorAll('pre code').forEach((block) => {
			hljs.highlightBlock(block);
		});

		document.querySelectorAll('[data-post-date]').forEach((postDate) => {
			// Highlight post dates that are less than 48 hours old.
			if (Date.parse(postDate.dataset.postDate) > (Date.now() - 1000 * 60 * 60 * 48)) {
				postDate.classList.add("post-recent-highlight");
			};
		});

		// Initialize lightbox.
		new Tobii({
			zoom: false,
		});

		// Update any download link to point to identified user's OS.
		const links = document.querySelectorAll('.set-os-download-url');
		for (let i = 0; i < links.length; i++) {
			const link = links[i];
			let link_slug = 'download';
			if ('version' in link.dataset && link.dataset['version'] === '3') {
				link_slug = 'download/3.x';
			}

			let link_platform = 'windows';
			if (navigator.platform.indexOf('Mac') !== -1) {
				link_platform = 'macos';
			} else if (navigator.platform.indexOf('Linux') !== -1) {
				link_platform = 'linux';
			}

			link.href = `/${link_slug}/${link_platform}/`;
		}
	});
</script>


</body>

</html>
