<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="Godot Engine">
	<meta name="description" content="Free and open source 2D and 3D game engine">
	<meta name="theme-color" content="#3d8fcc">
	<meta property="og:site_name" content="Godot Engine">
	<meta property="og:url" content="https://godotengine.org">
	<meta name="twitter:site" content="@godotengine">

	<meta property="og:title" content="Godot's ragdoll system">
	<meta property="og:description" content="Free and open source 2D and 3D game engine">
	<meta property="og:image" content="https://godotengine.org/storage/app/uploads/public/5af/c2e/449/5afc2e44937d1306025773.png">
	<meta property="og:type" content="article">
	<meta name="twitter:card" content="summary_large_image">
	<title>Godot's ragdoll system</title>

	<link rel="alternate" type="application/rss+xml" title="Godot News" href="/rss.xml">
	<link rel="icon" href="/assets/favicon.png" sizes="any">
	<link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
	<link rel="stylesheet" href="/assets/css/main.css">
	<link rel="stylesheet" href="/assets/css/tobii.min.css">
	<link rel="preload" as="font" href="/assets/fonts/Montserrat-Bold.woff2" crossorigin>
	<link rel="preload" as="font" href="/assets/fonts/Montserrat-ExtraBold.woff2" crossorigin>
	<link rel="me" href="https://mastodon.gamedev.place/@godotengine">
</head>

<body>
	<input type="checkbox" id="nav_toggle_cb">
<header>
	<div class="container flex align-center">
		<div id="nav_head">
			<a href="/" id="logo-link">
				<img class="nav-logo" src="/assets/logo.svg" width="136" height="48" alt="Godot Engine">
				<img class="nav-logo dark-logo" src="/assets/logo_dark.svg" width="136" height="48" alt="Godot Engine">
			</a>
			<label for="nav_toggle_cb" id="nav_toggle_btn">
				<img src="/assets/hamburger.svg" width="24" height="24" alt="">
			</label>
		</div>

		<nav id="nav">
			<ul class="left">
				<li><a href="/showcase">Showcase</a></li>
				<div class="only-on-mobile" style="width: 100%">
					<li><a href="/features">Features</a></li>
				</div>
				<li><a href="/blog">Blog</a></li>
				<li><a href="/community">Community</a></li>
				<li><a href="/contact">About</a></li>
				<li><a href="https://godotengine.org/asset-library/asset">Assets</a></li>
			</ul>

			<ul class="right">
				<li><a href="/download/windows" class="set-os-download-url">Download</a></li>
				<li><a href="https://docs.godotengine.org">Learn</a></li>
				<li><a href="https://docs.godotengine.org/en/stable/community/contributing/index.html">Contribute</a></li>
				
				<li class="fund"><a href="/donate">❤&#xFE0E; Donate</a></li>
			</ul>
		</nav>
	</div>
</header>

<main>


<style>
	body {
		background-color: var(--background-color);
	}

	h1 {
		margin-bottom: 8px;
		margin-top: 32px;
	}

	:not(pre)>code {
		background: var(--code-background-color);
		padding: 1px 4px;
		font-size: 0.95em;
		border-radius: 3px;
	}

	pre {
		background: var(--codeblock-background-color);
		color: var(--codeblock-color);
	}

	pre code {
		display: block;
		overflow-x: auto;
		padding: .5em;
	}

	.date-big {
		line-height: 2;
		margin-left: 32px;
	}

	article {
		background-color: var(--base-color);
		box-shadow: 0px 3px 2px 0px rgba(0, 0, 0, 0.15);
	}

	figure {
		margin: 0;
	}

	figure img {
		margin: 0;
	}

	article img,
	article video {
		max-width: 100%;
		height: auto;
		display: block;
		margin: auto;
		margin-top: 16px;
		margin-bottom: 16px;
	}

	article h1 {
		margin-top: 64px;
	}

	article h2,
	article h3,
	article h4 {
		margin-top: 42px;
	}

	.author {
		margin-top: 0px;
		margin-bottom: 64px;
	}

	.tag.active {
		filter: saturate(0.75);
	}

	@media screen and (min-width: 900px) {
		article .content {
			width: 70%;
			margin: auto;
		}
	}

	@media (max-width: 900px) {
		body {
			background-color: var(--base-color);
		}

		article {
			background-color: transparent;
			box-shadow: none;
		}

		article img:first-child,
		article video:first-child {
			max-width: 100%;
		}
	}
</style>

<link rel="stylesheet" href="/assets/css/highlight.obsidian.min.css">

<div class="container">
	<article class="flex padded">
		<div class="content content-article">
			<figure>
				<img src="/storage/app/uploads/public/5af/c2e/449/5afc2e44937d1306025773.png" title=""
					alt=" " class="rounded-lg"
					style="width: 100%; height: auto" />
				<figcaption style="opacity: 0.8; line-height: 1.5">
					<strong></strong>
					<span style="margin-left: 0.75rem; font-size: 90%"></span>
				</figcaption>
			</figure>

			<div class="info">
				<h1>
					Godot's ragdoll system
				</h1>
				<h4 class="author">
					By: Andrea Catania
					<span class="date"> 16 May 2018</span>
				</h4>

				<div class="tags">
					
					<a href="/blog/progress-report">
						<div class="tag active">Progress Report</div>
					</a>
					
				</div>
			</div>

			<p>Godot is getting more and more interesting features in this period, and one aspect on which we are focusing on is the Skeleton node.</p>

<p>We are working on implementing some features like Inverse Kinematics, Ragdoll, a better animation player, and a state machine player. All these things will allow the developers and artists to apply some animations to their characters easily and at the same time with an awesome result.</p>

<p>I’m <a href="https://github.com/AndreaCatania">Andrea Catania</a>, and in this article I will explain how to use the new Ragdoll feature available in Godot (in the <em>master</em> branch coming in Godot 3.1). But I’ll start with a couple lines to introduce myself. I’m the contributor who integrated the <a href="http://bulletphysics.org/wordpress/">Bullet Physics</a> engine in Godot 3.0, which was my first Pull Request about a year ago. I’m now taking care of most physics things and animation (like ragdoll, IK, SoftBody, etc.). I’m a computer graphics and physics passionate, and always looking to learn and discover new things.</p>

<p>Now let’s start!</p>

<h2 id="how-it-works">How it works</h2>

<p>To show you how to use it, I will apply it to the Platformer3D demo that can be downloaded <a href="https://github.com/godotengine/godot-demo-projects/tree/master/3d/platformer">on GitHub</a> or on the <a href="https://godotengine.org/asset-library/asset/125">Asset Library</a>.</p>

<h4 id="create-physical-bones">Create physical bones</h4>

<p>The first thing to do is to select the skeleton node (in the player scene of <em>Robi</em> the robot). You will notice that a skeleton button appears on the top bar menu:</p>

<p><img src="/storage/app/uploads/public/5af/ab9/c72/5afab9c7200ce584291865.png" alt="Skeleton menu" /></p>

<p>Click it and select the <strong>Create physical skeleton</strong> option. The engine will automatically generate physical bones (with their own shape) for each bone of the skeleton.</p>

<p><img src="/storage/app/uploads/public/5af/abb/094/5afabb09460a2307518203.png" alt="Generated physical bones" /></p>

<h4 id="clean-up-the-skeleton">Clean up the skeleton</h4>

<p>In the picture above, you can see that there are unnecessary physical bones like the MASTER bone, so the first thing to do is to clean up our skeleton by removing these physical bones.</p>

<p>The rule is that you should remove all physical bones that are too small to make a difference in the simulation and all utility bones (like the MASTER bone in this case).</p>

<blockquote>
  <p>For example, if we take a humanoid skeleton where the hand is comprised of many bones, it’s really useless and wasteful to maintain all bones of the hand. One important thing to do in this case is to remove all physical bones and replace them by one or two bones to simulate the hand.</p>
</blockquote>

<p>To clean up our Robi I chose to remove these physical bones: MASTER, waist, neck, headtracker.
This step is not mandatory but it is recommend to clean up the generated skeleton, so that you end up with an easy to maintain and optimized skeleton structure.</p>

<h4 id="collision-shape-adjustment">Collision shape adjustment</h4>

<p>After cleaning it up you will have to adjust the collision shape and/or the size of physical bones in order to match the part of body that each bone should simulate.</p>

<p><img src="/storage/app/uploads/public/5af/afd/4b9/5afafd4b943a5862540602.gif" alt="Moving joints of physical bones" /></p>

<h4 id="joints-adjustment">Joints adjustment</h4>

<p>After the collision shapes adjustment your ragdoll is ready to be used, but before doing it I like to change the joint between each bone.</p>

<p>The joint assigned by default is <strong>Pin Joint</strong> that doesn’t has any constraint. To change it you should select the physical bone then change the type of constraint in the Joint section. It’s possible to change the orientation of constraint and limits.</p>

<p><img src="/storage/app/uploads/public/5af/b01/7cd/5afb017cd3171367834249.gif" alt="Moving joints of physical bones" /></p>

<p>Now Robi’s head will move like a real head!</p>

<p>My final result is this:</p>

<p><img src="/storage/app/uploads/public/5af/b02/33b/5afb0233ba705924328561.png" alt="Final physical skeleton" /></p>

<h4 id="start-and-stop-the-simulation">Start and stop the simulation</h4>

<p>Now it’s really simple to start the simulation by attaching a GDScript and writing down this code:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func _ready():
    physical_bones_start_simulation()
</code></pre></div></div>

<p>To stop it you can call the function <code class="language-plaintext highlighter-rouge">physical_bones_stop_simulation()</code>.</p>

<p><img src="/storage/app/uploads/public/5af/b0b/607/5afb0b607ab79099759831.gif" alt="Video of ragdoll simulation" /></p>

<p>But what if I want to start the simulation for just a few parts of the body? Yes, it’s simple enough to do by changing only one line of code: :P</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>func _ready():
    physical_bones_start_simulation(["r-arm", "l-arm"])
</code></pre></div></div>

<p>With the code above, we are passing to the engine the names of bones for which we would like to simulate physics, and this is the result:</p>

<p><img src="/storage/app/uploads/public/5af/b06/c69/5afb06c693617870253401.gif" alt="Ragdoll simulation with only arm bones" /></p>

<h2 id="collision-layer-and-mask">Collision Layer and Mask</h2>

<p>Last but not least you have to properly set layer and mask in a way that doesn’t collide with kinematic capsule but collide with ground:</p>

<p><img src="/storage/app/uploads/public/5af/c73/2f8/5afc732f8071b214206421.png" alt="Untitled.png" /></p>

<h2 id="whats-next">What’s next?</h2>

<p>The next thing that I will implement is the active ragdolls that will allow us to influence the physical bone position. This mean that the body will tend to maintain a defined position while ragdoll is active.</p>

<p>That’s it for now, enjoy ragdolling!</p>

		</div>
	</article>
</div>



</main>

<footer>
	<div class="container flex">
		<div id="copyright">
			<p>
				© 2007-2023 Juan Linietsky, Ariel Manzur and <a
					href="https://github.com/godotengine/godot/blob/master/AUTHORS.md" target="_blank"
					rel="noopener">contributors</a><br>
				Godot is a member of the <a href="https://sfconservancy.org/" target_="_blank" rel="noopener">Software Freedom
					Conservancy</a>.<br>
				Kindly hosted by <a href="https://tuxfamily.org" target="_blank" rel="noopener">TuxFamily.org</a>.<br>
				<a href="https://github.com/godotengine/godot-website" target="_blank" rel="noopener">Website source code on
					GitHub</a>.
			</p>
		</div>
		<div id="sitemap">
			<ul class="sitemap-group">
				<li><strong>Get Godot</strong></li>
				<li><a href="/download/windows" class="set-os-download-url">Download</a></li>
				<li><a href="https://editor.godotengine.org/releases/latest/">Web Editor</a></li>
				<li>&nbsp;</li>
				<li><strong>Public Relations</strong></li>
				<li><a href="/blog">Blog</a></li>
				<li><a href="/community">Communities and Events</a></li>
				<li><a href="/press">Press Kit</a></li>
			</ul>
			<ul class="sitemap-group">
				<li><strong>About Godot</strong></li>
				<li><a href="/features">Features</a></li>
				<li><a href="/showcase">Showcase</a></li>
				<li><a href="/education">Education</a></li>
				<li><a href="/license">License</a></li>
				<li><a href="/code-of-conduct">Code of Conduct</a></li>
				<li><a href="/privacy-policy">Privacy Policy</a></li>
				<li><a href="/donate">Donate</a></li>
			</ul>
			<ul class="sitemap-group">
				<li><strong>Project Team</strong></li>
				<li><a href="/governance">Governance</a></li>
				<li><a href="/teams">Teams</a></li>
				<li>&nbsp;</li>
				<li><strong>Extra Resources</strong></li>
				<li><a href="/asset-library/asset">Asset Library</a></li>
				<li><a href="https://docs.godotengine.org">Documentation</a></li>
				<li><a href="https://github.com/godotengine">Code Repository</a></li>
			</ul>
		</div>
		<div id="social" class="dark-desaturate">
			<h4 class="text-right"><a href="/contact">Contact us</a></h4>
			<div class="flex justify-space-between">
				<a href="https://github.com/godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/github_logo.svg" width="32" height="32" alt="GitHub">
				</a>
				<a href="https://twitter.com/godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/twitter_logo.svg" width="32" height="32" alt="Twitter">
				</a>
				<a href="https://www.facebook.com/groups/godotengine/" target="_blank" rel="noopener">
					<img src="/assets/footer/facebook_logo.svg" width="32" height="32" alt="Facebook">
				</a>
				<a href="https://www.reddit.com/r/godot" target="_blank" rel="noopener">
					<!-- Zero-width space in the `alt` text to prevent content blockers from blocking the icon -->
					<img src="/assets/footer/reddit_logo.svg" width="32" height="32" alt="Red​dit">
				</a>
				<a href="/rss.xml" target="_blank" rel="noopener">
					<!-- Icon is called `feed` instead of `rss` to prevent content blockers from blocking the icon -->
					<img src="/assets/footer/feed_logo.svg" width="32" height="32" alt="RSS feed">
				</a>
			</div>
		</div>
	</div>
</footer>

<script defer src="/assets/js/tobii.min.js"></script>
<script defer src="/assets/js/highlight.min.js?1"></script>
<script defer src="/assets/js/highlight.gdscript.min.js?1"></script>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		// This needs to be done on page load but also after page changes,
		// in case a code block appears in an article.
		document.querySelectorAll('pre code').forEach((block) => {
			hljs.highlightBlock(block);
		});

		document.querySelectorAll('.content-article img').forEach((articleImg) => {
			// Add lightbox elements in blog articles for Tobii.
			const lightbox = document.createElement('a');
			lightbox.href = articleImg.src;
			lightbox.classList.add('lightbox');
			lightbox.dataset.group = 'article';
			articleImg.parentNode.appendChild(lightbox);
			lightbox.appendChild(articleImg);
		});

		// Initialize lightbox.
		new Tobii({
			zoom: false,
		});
	});

	// Update any download link to point to identified user's OS.
	const links = document.querySelectorAll('.set-os-download-url');
	for (let i = 0; i < links.length; i++) {
		const link = links[i];
		link.href = "/download/windows";
		if (navigator.platform.indexOf('Mac') !== -1) {
			link.href = "/download/macos";
		} else if (navigator.platform.indexOf('Linux') !== -1) {
			link.href = "/download/linux";
		}
	}
</script>


</body>

</html>
