<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<meta name="author" content="Godot Engine">
	<meta name="description" content="No need to "eval"! A whole new interface to interact with JavaScript from Godot Scripts in Web exports, and a new API to prompt the user to download a file generated by Godot.">
	<meta name="theme-color" content="#3d8fcc">
	<meta property="og:site_name" content="Godot Engine">
	<meta property="og:url" content="https://godotengine.org/article/godot-web-progress-report-9/">
	<meta name="twitter:site" content="@godotengine">

	<meta property="og:title" content="Godot Web progress report #9: Godot Scripts <-> JavaScript Interface">
	<meta property="og:description" content="No need to "eval"! A whole new interface to interact with JavaScript from Godot Scripts in Web exports, and a new API to prompt the user to download a file generated by Godot.">
	<meta property="og:image" content="https://godotengine.org/storage/app/uploads/public/60c/dfe/795/60cdfe7956fca023522866.png">
	<meta property="og:type" content="article">
	<meta name="twitter:card" content="summary_large_image">
	<title>Godot Web progress report #9: Godot Scripts <-> JavaScript Interface</title>

	<link rel="alternate" type="application/rss+xml" title="Godot News" href="/rss.xml">
	<link rel="icon" href="/assets/favicon.png" sizes="any">
	<link rel="icon" href="/assets/favicon.svg" type="image/svg+xml">
	<link rel="stylesheet" href="/assets/css/main.css?111">
	<link rel="stylesheet" href="/assets/css/tobii.min.css">
	<link rel="preload" as="font" href="/assets/fonts/Montserrat-Bold.woff2" crossorigin>
	<link rel="preload" as="font" href="/assets/fonts/Montserrat-ExtraBold.woff2" crossorigin>
	<link rel="me" href="https://mastodon.gamedev.place/@godotengine">
</head>

<body>
	<input type="checkbox" id="nav_toggle_cb">
<header>
	<div class="container flex align-center">
		<div id="nav_head">
			<a href="/" id="logo-link">
				<img class="nav-logo" src="/assets/logo.svg" width="136" height="48" alt="Godot Engine">
				<img class="nav-logo dark-logo" src="/assets/logo_dark.svg" width="136" height="48" alt="Godot Engine">
			</a>
			<label for="nav_toggle_cb" id="nav_toggle_btn">
				<img src="/assets/icons/hamburger.svg" width="24" height="24" alt="Main menu">
			</label>
		</div>

		<nav id="nav">
			<ul class="left">
				<li><a href="/features">Features</a></li>
				<li class="only-on-mobile"><a href="/showcase">Showcase</a></li>
				<li><a href="/blog">Blog</a></li>
				<li><a href="/community">Community</a></li>
				<li><a href="/contact">About</a></li>
				<li><a href="https://godotengine.org/asset-library/asset">Assets</a></li>
			</ul>

			<ul class="right">
				<li><a href="/download/windows" class="set-os-download-url">Download</a></li>
				<li><a href="https://docs.godotengine.org">Learn</a></li>
				<li><a href="https://docs.godotengine.org/en/stable/community/contributing/index.html">Contribute</a></li>
				
				<li class="fund"><a href="https://fund.godotengine.org">❤&#xFE0E; Donate</a></li>
			</ul>
		</nav>
	</div>
</header>

<main>


<style>
	body {
		background-color: var(--background-color);
	}

	h1 {
		margin-bottom: 8px;
		margin-top: 32px;
	}

	:not(pre)>code {
		background: var(--code-background-color);
		padding: 1px 4px;
		font-size: 0.95em;
		border-radius: 3px;
	}

	pre {
		background: var(--codeblock-background-color);
		color: var(--codeblock-color);
	}

	pre code {
		display: block;
		overflow-x: auto;
		padding: .5em;
	}

	.date-big {
		line-height: 2;
		margin-left: 32px;
	}

	article {
		background-color: var(--base-color);
		box-shadow: 0px 3px 2px 0px rgba(0, 0, 0, 0.15);
	}

	figure {
		margin: 0;
	}

	figure img {
		margin: 0;
	}

	article img,
	article video {
		max-width: 100%;
		height: auto;
		display: block;
		margin: auto;
		margin-top: 16px;
		margin-bottom: 16px;
	}

	article h1 {
		margin-top: 64px;
	}

	article h2,
	article h3,
	article h4 {
		margin-top: 42px;
	}

	.article-info {
		display: flex;
		flex-direction: column;
		gap: 8px;
	}

	.article-metadata {
		display: flex;
		gap: 24px;
		align-items: center;
		font-family: var(--header-font-family);
		margin-bottom: 12px;
	}

	@media (max-width: 900px) {
		.article-metadata {
			flex-direction: column;
			align-items: flex-start;
			gap: 16px;
		}
	}

	.article-author {
		color: var(--base-color-text-subtitle-date);
		font-weight: 700;
		font-size: 18px;
		flex-grow: 1;
		display: flex;
		gap: 12px;
		align-items: center;
	}

	.article-author .avatar {
		border-radius: 100%;
		margin: 0;
	}

	.article-author .by {
		color: var(--base-color-text-subtitle);
	}

	.article-metadata .date {
		color: var(--base-color-text-subtitle-date);
	}

	.article-metadata .date.post-recent-highlight {
		color: var(--post-recent-highlight-color);
		opacity: 0.8;
	}

	.article-metadata .date.post-recent-highlight::after {
		font-size: 80%;
		content: "NEW";
		border: 2px solid var(--post-recent-highlight-color);
		padding: 2px 3px;
		margin-left: 8px;
	}

	.tag.active {
		filter: saturate(0.75);
	}

	@media screen and (min-width: 900px) {
		article .content {
			width: 70%;
			margin: auto;
		}
	}

	@media (max-width: 900px) {
		body {
			background-color: var(--base-color);
		}

		article {
			background-color: transparent;
			box-shadow: none;
		}

		article img:first-child,
		article video:first-child {
			max-width: 100%;
		}
	}
</style>

<link rel="stylesheet" href="/assets/css/highlight.obsidian.min.css">

<div class="container">
	<article class="padded">
		<div class="content article-container">
			<figure class="article-cover">
				

				<img src="/storage/app/uploads/public/60c/dfe/795/60cdfe7956fca023522866.png" title=""
					alt=" " class="rounded-lg"
					style="width: 100%; height: auto; background-color: transparent;" />
			</figure>

			<div class="article-info">
				<h1>
					Godot Web progress report #9: Godot Scripts <-> JavaScript Interface
				</h1>
				<div class="article-metadata">
					<div class="article-author">
						<span>By: </span>
						
						
							<img class="avatar" width="25" height="25" src="/assets/images/authors/faless.webp" alt="Fabio Alessandrelli" loading="lazy">
						
						<span class="by">Fabio Alessandrelli</span>
					</div>
					<span class="date" data-post-date="2021-06-30 16:20:00 +0000"> 30 June 2021</span>
				</div>

				<div class="tags">
					
					<a href="/blog/progress-report">
						<div class="tag active">Progress Report</div>
					</a>
					
				</div>
			</div>

			



	<div class="card card-warning">
		<p>
		
			This article is from <strong>June 2021</strong>, some of its contents might be outdated and no longer accurate.<br>
			You can find up-to-date information about the engine in the <a href="https://docs.godotengine.org/en/stable/">official documentation</a>.
		
		</p>
	</div>





			<div class="article-body">
				<p>Howdy Godotters!</p>

<p>It hasn’t been long since the <a href="https://godotengine.org/article/godot-web-progress-report-8">last Web progress report</a>, but it’s finally time for the blog entry you have probably been waiting for… time to talk about <strong>integrating Godot with third-party JavaScript APIs on the Web</strong>.</p>

<h3 id="motivation">Motivation</h3>

<p>Sometimes, when exporting Godot for the Web, it might be necessary to interface with external JavaScript code. Things like third-party SDKs, libraries, or simply accessing browser features that are not directly exposed by Godot.</p>

<p>Historically, this has been done in Godot via the <a href="https://docs.godotengine.org/en/stable/classes/class_javascript.html#class-javascript-method-eval"><code class="language-plaintext highlighter-rouge">JavaScript.eval</code></a> method. This relied on the JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/eval"><code class="language-plaintext highlighter-rouge">eval()</code> function</a>, which beside being dangerous when misused, is also <a href="https://docs.godotengine.org/en/3.3/getting_started/workflow/export/exporting_for_web.html#calling-javascript-from-script">quite cumbersome to use</a>.</p>

<p>For these reasons, a <strong>new interface</strong> has been developed. This new interface feels more natural in the context of Godot scripting (e.g. GDScript and C#).</p>

<h3 id="javascriptobject">JavaScriptObject</h3>

<p>A new <code class="language-plaintext highlighter-rouge">JavaScriptObject</code> class has been added that wraps around native JavaScript objects and allows to call JavaScript methods and retrieve object properties.</p>

<p>You can access a JavaScript object via two new methods in the <a href="https://docs.godotengine.org/en/latest/classes/class_javascript.html"><code class="language-plaintext highlighter-rouge">JavaScript</code></a> singleton:</p>

<ul>
  <li><code class="language-plaintext highlighter-rouge">JavaScript.get_interface()</code>: Retrieves and wraps around an object in the global scope by calling a new method.</li>
</ul>

<div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">extends</span> <span class="n">Node</span>

<span class="k">func</span> <span class="nf">_ready</span><span class="p">():</span>
    <span class="c1"># Retrieve the `window.console` object.</span>
    <span class="k">var</span> <span class="n">console</span> <span class="o">=</span> <span class="n">JavaScript</span><span class="o">.</span><span class="n">get_interface</span><span class="p">(</span><span class="s2">"console"</span><span class="p">)</span>
    <span class="c1"># Call the `window.console.log()` method.</span>
    <span class="n">console</span><span class="o">.</span><span class="nb">log</span><span class="p">(</span><span class="s2">"test"</span><span class="p">)</span>
</code></pre></div></div>

<ul>
  <li><code class="language-plaintext highlighter-rouge">JavaScript.create_object()</code>: Create an object via the JavaScript <code class="language-plaintext highlighter-rouge">new</code> constructor.</li>
</ul>

<div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">extends</span> <span class="n">Node</span>

<span class="k">func</span> <span class="nf">_ready</span><span class="p">():</span>
    <span class="c1"># Call the JavaScript `new` operator on the `window.Array` object.</span>
    <span class="c1"># Passing 10 as argument to the constructor:</span>
    <span class="c1"># JS: `new Array(10);`</span>
    <span class="k">var</span> <span class="n">arr</span> <span class="o">=</span> <span class="n">JavaScript</span><span class="o">.</span><span class="n">create_object</span><span class="p">(</span><span class="s2">"Array"</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
    <span class="c1"># Set the first element of the JavaScript array to the number 42.</span>
    <span class="n">arr</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">42</span>
    <span class="c1"># Call the `pop` function on the JavaScript array.</span>
    <span class="n">arr</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
    <span class="c1"># Print the value of the `length` property of the array (9 after the pop).</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">arr</span><span class="o">.</span><span class="n">length</span><span class="p">)</span>
</code></pre></div></div>

<p>As you can see, thanks to Godot’s internal <a href="https://docs.godotengine.org/en/stable/classes/class_object.html">Object</a> design, you can interact with JavaScript objects obtained that way like they were native Godot objects, calling their methods, and retrieving (or even setting) their properties.</p>

<p>Base types (int, floats, strings, booleans) are automatically converted (floats might lose precision when converted from JavaScript to Godot the first time). Anything else (i.e. objects, arrays, functions) are seen as <code class="language-plaintext highlighter-rouge">JavaScriptObject</code>s themselves.</p>

<p>If you wonder where the magic lies and don’t mind digging into the C++ codebase, it was “just” a matter of creating a new <a href="https://github.com/godotengine/godot/blob/3.x/platform/javascript/javascript_singleton.cpp"><code class="language-plaintext highlighter-rouge">Object</code> child class</a> and overriding the <code class="language-plaintext highlighter-rouge">_get</code>, <code class="language-plaintext highlighter-rouge">_set</code>, <code class="language-plaintext highlighter-rouge">setvar</code>, <code class="language-plaintext highlighter-rouge">getvar</code>, and <code class="language-plaintext highlighter-rouge">call</code> methods… plus a painful amount of <a href="https://github.com/godotengine/godot/blob/3.x/platform/javascript/js/libs/library_godot_javascript_singleton.js">JavaScript glue code</a>.</p>

<p>But there’s more! Let’s talk about…</p>

<h3 id="callbacks">Callbacks</h3>

<p>Calling JavaScript code from Godot is nice, but sometimes you need to call a Godot function from JavaScript instead.</p>

<p>This case is a bit more complicated. JavaScript relies on garbage collection, while Godot uses reference counting for memory management. This means you have to explicitly create callabacks (which are returned as <code class="language-plaintext highlighter-rouge">JavaScriptObject</code>s themselves) and you have to keep their reference.</p>

<p>Arguments passed by JavaScript to the callback will be passed as a single Godot <code class="language-plaintext highlighter-rouge">Array</code>.</p>

<p>But don’t worry if this sounds a bit technical, it’s not too hard.</p>

<p>Here is an example to set the JavaScript <a href="https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers#properties"><code class="language-plaintext highlighter-rouge">window.onbeforeunload</code></a> property which asks a user for confirmation when leaving the web page:</p>

<div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">extends</span> <span class="n">Node</span>

<span class="c1"># Here create a reference to the `_my_callback` function (below).</span>
<span class="c1"># This reference will be kept until the node is freed.</span>
<span class="k">var</span> <span class="n">_callback_ref</span> <span class="o">=</span> <span class="n">JavaScript</span><span class="o">.</span><span class="n">create_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_my_callback"</span><span class="p">)</span>

<span class="k">func</span> <span class="nf">_ready</span><span class="p">():</span>
    <span class="c1"># Get the JavaScript `window` object.</span>
    <span class="k">var</span> <span class="n">window</span> <span class="o">=</span> <span class="n">JavaScript</span><span class="o">.</span><span class="n">get_interface</span><span class="p">(</span><span class="s2">"window"</span><span class="p">)</span>
    <span class="c1"># Set the `window.onbeforeunload` DOM event listener.</span>
    <span class="n">window</span><span class="o">.</span><span class="n">onbeforeunload</span> <span class="o">=</span> <span class="n">_callback_ref</span>

<span class="k">func</span> <span class="nf">_my_callback</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="c1"># Get the first argument (the DOM event in our case).</span>
    <span class="k">var</span> <span class="n">js_event</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="c1"># Call preventDefault and set the `returnValue` property of the DOM event.</span>
    <span class="n">js_event</span><span class="o">.</span><span class="n">preventDefault</span><span class="p">()</span>
    <span class="n">js_event</span><span class="o">.</span><span class="n">returnValue</span> <span class="o">=</span> <span class="s2">'</span><span class="s1">'</span>
</code></pre></div></div>

<p>Here is another example that asks the user for the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Notifications_API">Notification permission</a> and waits asynchronously to deliver a notification if the permission is granted:</p>

<div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">extends</span> <span class="n">Node</span>

<span class="c1"># Here create a reference to the `_on_permissions` function (below).</span>
<span class="c1"># This reference will be kept until the node is freed.</span>
<span class="k">var</span> <span class="n">_permission_callback</span> <span class="o">=</span> <span class="n">JavaScript</span><span class="o">.</span><span class="n">create_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_on_permissions"</span><span class="p">)</span>

<span class="k">func</span> <span class="nf">_ready</span><span class="p">():</span>
    <span class="c1"># NOTE: This is done in `_ready` for semplicity, but SHOULD BE done in response</span>
    <span class="c1"># to user input instead (e.g. during `_input`, or `button_pressed` event, etc.),</span>
    <span class="c1"># otherwise it might not work.</span>

    <span class="c1"># Get the `window.Notification` JavaScript object.</span>
    <span class="k">var</span> <span class="n">notification</span> <span class="o">=</span> <span class="n">JavaScript</span><span class="o">.</span><span class="n">get_interface</span><span class="p">(</span><span class="s2">"Notification"</span><span class="p">)</span>
    <span class="c1"># Call the `window.Notification.requestPermission` method which returns a JavaScript</span>
    <span class="c1"># Promise, and bind our callback to it.</span>
    <span class="n">notification</span><span class="o">.</span><span class="n">requestPermission</span><span class="p">()</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">_permission_callback</span><span class="p">)</span>

<span class="k">func</span> <span class="nf">_on_permissions</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
    <span class="c1"># The first argument of this callback is the string "granted" if the permission is granted.</span>
    <span class="k">var</span> <span class="n">permission</span> <span class="o">=</span> <span class="n">args</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">permission</span> <span class="o">==</span> <span class="s2">"granted"</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"Permission granted, sending notification."</span><span class="p">)</span>
        <span class="c1"># Create the notification: `new Notification("Hi there!")`</span>
        <span class="n">JavaScript</span><span class="o">.</span><span class="n">create_object</span><span class="p">(</span><span class="s2">"Notification"</span><span class="p">,</span> <span class="s2">"Hi there!"</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">"No notification permission."</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="but-can-i-use-library-x">But can I use library X?</h3>

<p>You most likely can, and it shouldn’t be too cumbersome. First, you have to include your library in the page. You can simply customize the <code class="language-plaintext highlighter-rouge">Head Include</code> during export (see below), or even <a href="https://docs.godotengine.org/en/stable/tutorials/platform/customizing_html5_shell.html">write your own template</a>.</p>

<p>In the example below, we customize the <strong>Head Include</strong> to add an external library (<a href="https://axios-http.com/">axios</a>) from a content delivery network, and a second <code class="language-plaintext highlighter-rouge">&lt;script&gt;</code> tag to define our own custom function:</p>

<div class="language-html highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="c">&lt;!-- Axios --&gt;</span>
<span class="nt">&lt;script </span><span class="na">src=</span><span class="s">"https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"</span><span class="nt">&gt;&lt;/script&gt;</span>
<span class="c">&lt;!-- Custom function --&gt;</span>
<span class="nt">&lt;script&gt;</span>
<span class="kd">function</span> <span class="nx">myFunc</span><span class="p">()</span> <span class="p">{</span>
    <span class="nx">alert</span><span class="p">(</span><span class="dl">"</span><span class="s2">My func!</span><span class="dl">"</span><span class="p">);</span>
<span class="p">}</span>
<span class="nt">&lt;/script&gt;</span>
</code></pre></div></div>
<p><img src="/storage/app/uploads/public/60c/ddb/7a5/60cddb7a5c331340661868.png" alt="HTML5 export head include setting" /></p>

<p>We can then access both the library and the function from Godot, like we did in previous examples:</p>

<div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">extends</span> <span class="n">Node</span>

<span class="c1"># Here create a reference to the `_on_get` function (below).</span>
<span class="c1"># This reference will be kept until the node is freed.</span>
<span class="k">var</span> <span class="n">_callback</span> <span class="o">=</span> <span class="n">JavaScript</span><span class="o">.</span><span class="n">create_callback</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s2">"_on_get"</span><span class="p">)</span>

<span class="k">func</span> <span class="nf">_ready</span><span class="p">():</span>
	<span class="c1"># Get the `window` object, where globally defined functions are.</span>
	<span class="k">var</span> <span class="n">window</span> <span class="o">=</span> <span class="n">JavaScript</span><span class="o">.</span><span class="n">get_interface</span><span class="p">(</span><span class="s2">"window"</span><span class="p">)</span>
	<span class="c1"># Call the JavaScript `myFunc` function defined in the custom HTML head.</span>
	<span class="n">window</span><span class="o">.</span><span class="n">myFunc</span><span class="p">()</span>
	<span class="c1"># Get the `axios` library (loaded from a CDN in the custom HTML head).</span>
	<span class="k">var</span> <span class="n">axios</span> <span class="o">=</span> <span class="n">JavaScript</span><span class="o">.</span><span class="n">get_interface</span><span class="p">(</span><span class="s2">"axios"</span><span class="p">)</span>
	<span class="c1"># Make a GET request to the current location, and receive the callback when done.</span>
	<span class="n">axios</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">window</span><span class="o">.</span><span class="n">location</span><span class="o">.</span><span class="n">toString</span><span class="p">())</span><span class="o">.</span><span class="n">then</span><span class="p">(</span><span class="n">_callback</span><span class="p">)</span>

<span class="k">func</span> <span class="nf">_on_get</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
	<span class="n">OS</span><span class="o">.</span><span class="n">alert</span><span class="p">(</span><span class="s2">"On Get"</span><span class="p">)</span>
</code></pre></div></div>

<p>And one last treat…</p>

<h3 id="downloading-files">Downloading files</h3>

<p>A lot of you asked for an easy way to “download files” (e.g. game saves) from the Godot HTML5 export to the user computer.</p>

<p>This has been done with <code class="language-plaintext highlighter-rouge">eval()</code> before, and can also be done with the new interface described above.</p>

<p>Given it has a very common use case though, we decided to expose this functionality to scripting via a dedicated <code class="language-plaintext highlighter-rouge">JavaScript.download_buffer()</code> function which lets you download any generated buffer.</p>

<p>Here is a minimal example on how to use it:</p>

<div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">extends</span> <span class="n">Node</span>

<span class="k">func</span> <span class="nf">_ready</span><span class="p">():</span>
    <span class="c1"># Asks the user download a file called "hello.txt" whose content will be the string "Hello".</span>
	<span class="n">JavaScript</span><span class="o">.</span><span class="n">download_buffer</span><span class="p">(</span><span class="s2">"Hello"</span><span class="o">.</span><span class="n">to_utf8</span><span class="p">(),</span> <span class="s2">"hello.txt"</span><span class="p">)</span>
</code></pre></div></div>

<p>And here is a more complete example on how to download a previously saved file:</p>

<div class="language-gdscript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">extends</span> <span class="n">Node</span>

<span class="c1"># Open a file for reading and download it via the JavaScript singleton.</span>
<span class="k">func</span> <span class="nf">_download_file</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
	<span class="k">var</span> <span class="n">file</span> <span class="o">=</span> <span class="n">File</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
	<span class="k">if</span> <span class="n">file</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">File</span><span class="o">.</span><span class="n">READ</span><span class="p">)</span> <span class="o">!=</span> <span class="n">OK</span><span class="p">:</span>
		<span class="n">push_error</span><span class="p">(</span><span class="s2">"Failed to load file"</span><span class="p">)</span>
		<span class="k">return</span>
	<span class="c1"># Get the file name.</span>
	<span class="k">var</span> <span class="n">fname</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">get_file</span><span class="p">()</span>
	<span class="c1"># Read the whole file to memory.</span>
	<span class="k">var</span> <span class="n">buffer</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="n">get_buffer</span><span class="p">(</span><span class="n">file</span><span class="o">.</span><span class="n">get_len</span><span class="p">())</span>
	<span class="c1"># Prompt the user to download the file (will have the same name as the input file).</span>
	<span class="n">JavaScript</span><span class="o">.</span><span class="n">download_buffer</span><span class="p">(</span><span class="n">buffer</span><span class="p">,</span> <span class="n">fname</span><span class="p">)</span>

<span class="k">func</span> <span class="nf">_ready</span><span class="p">():</span>
	<span class="c1"># Create a temporary file.</span>
	<span class="k">var</span> <span class="n">config</span> <span class="o">=</span> <span class="n">ConfigFile</span><span class="o">.</span><span class="n">new</span><span class="p">()</span>
	<span class="n">config</span><span class="o">.</span><span class="n">set_value</span><span class="p">(</span><span class="s2">"option"</span><span class="p">,</span> <span class="s2">"one"</span><span class="p">,</span> <span class="bp">false</span><span class="p">)</span>
	<span class="n">config</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">"/tmp/test.cfg"</span><span class="p">)</span>

	<span class="c1"># Download it</span>
	<span class="n">_download_file</span><span class="p">(</span><span class="s2">"/tmp/test.cfg"</span><span class="p">)</span>
</code></pre></div></div>

<h3 id="future-work">Future work</h3>

<p>Working on the Godot HTML5 export for more than a year has been a great experience, and I love seeing the many developers releasing their Godot games and apps on the Web, even with the <a href="https://www.youtube.com/watch?v=RCUj6Rlq2mw">limitations this platform still has</a>. I like to think Godot can help revitalize the web games ecosystem.</p>

<p>While I will keep maintaining the HTML5 platform, and there will be some more news in the next months beside the usual bug fixing, it’s time to get back at the other aspect of Godot that’s been overlooked in the last year… Networking and Multiplayer! Those of you following GitHub development might have noticed something already, but there’s much more to come.</p>

<p>So stay tuned! :)</p>

<h3 id="references">References</h3>

<ul>
  <li><a href="https://github.com/godotengine/godot/pull/487190">Godot &lt;-&gt; JavaScript interface</a> and <a href="https://github.com/godotengine/godot/pull/48691">3.x version</a> (<a href="https://github.com/godotengine/godot-proposals/issues/1852">original proposal</a>)</li>
  <li><a href="https://github.com/godotengine/godot/pull/48881">Download API</a> and <a href="https://github.com/godotengine/godot/pull/48929">3.x version</a></li>
</ul>

			</div>
		</div>
	</article>
</div>

<link rel="stylesheet" href="/assets/css/anchor-link.css?1">
<link rel="stylesheet" href="/assets/css/article-cards.css?2">
<script src="/assets/js/anchor-link.js"></script>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		// Add icons to easily copy section links.
		window.applyAnchorLinks('.article-body');

		// Add lightbox elements in blog articles for Tobii.
		document.querySelectorAll('.article-cover img, .article-body img').forEach((articleImg) => {
			if (articleImg.classList.contains('lightbox-ignore')) {
				return;
			}

			const lightbox = document.createElement('a');
			lightbox.href = articleImg.src;
			lightbox.classList.add('lightbox');
			lightbox.dataset.group = 'article';
			articleImg.parentNode.appendChild(lightbox);
			lightbox.appendChild(articleImg);
		});
	});
</script>

</main>

<footer>
	<div class="container flex footer-container">
		<div id="copyright">
			<p>
				© 2007-2024 Juan Linietsky, Ariel Manzur and <a
					href="https://github.com/godotengine/godot/blob/master/AUTHORS.md" target="_blank"
					rel="noopener">contributors</a>.<br>
				Hosted by the <a href="https://godot.foundation/" target="_blank" rel="noopener">Godot Foundation</a>.<br>
				Website <a href="https://github.com/godotengine/godot-website" target="_blank" rel="noopener">source code on  GitHub</a>.
			</p>
		</div>
		<div id="sitemap">
			<ul class="sitemap-group">
				<li><strong>Get Godot</strong></li>
				<li><a href="/download/windows" class="set-os-download-url">Download</a></li>
				<li><a href="https://editor.godotengine.org/releases/latest/">Web Editor</a></li>
				<li>&nbsp;</li>
				<li><strong>Public Relations</strong></li>
				<li><a href="/blog">Blog</a></li>
				<li><a href="/community">Communities and Events</a></li>
				<li><a href="/press">Press Kit</a></li>
			</ul>
			<ul class="sitemap-group">
				<li><strong>About Godot</strong></li>
				<li><a href="/features">Features</a></li>
				<li><a href="/showcase">Showcase</a></li>
				<li><a href="/education">Education</a></li>
				<li><a href="/license">License</a></li>
				<li><a href="/code-of-conduct">Code of Conduct</a></li>
				<li><a href="/privacy-policy">Privacy Policy</a></li>
				<li><a href="https://fund.godotengine.org">Donate</a></li>
			</ul>
			<ul class="sitemap-group">
				<li><strong>Project Team</strong></li>
				<li><a href="/governance">Governance</a></li>
				<li><a href="/teams">Teams</a></li>
				<li>&nbsp;</li>
				<li><strong>Extra Resources</strong></li>
				<li><a href="/asset-library/asset">Asset Library</a></li>
				<li><a href="https://docs.godotengine.org">Documentation</a></li>
				<li><a href="https://github.com/godotengine">Code Repository</a></li>
			</ul>
		</div>
		<div id="social" class="dark-desaturate">
			<h4 class="text-right"><a href="/contact">Contact us</a></h4>
			<div class="flex justify-space-between" style="gap: 3px;">
				<a href="https://github.com/godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/github_logo.svg" width="32" height="32" alt="GitHub">
				</a>
				<a href="https://mastodon.gamedev.place/@godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/mastodon_logo.svg" width="32" height="32" alt="Mastodon">
				</a>
				<a href="https://twitter.com/godotengine" target="_blank" rel="noopener">
					<img src="/assets/footer/twitter_logo.svg" width="32" height="32" alt="Twitter">
				</a>
				<a href="https://www.facebook.com/groups/godotengine/" target="_blank" rel="noopener">
					<img src="/assets/footer/facebook_logo.svg" width="32" height="32" alt="Facebook">
				</a>
				<a href="https://www.reddit.com/r/godot" target="_blank" rel="noopener">
					<!-- Zero-width space in the `alt` text to prevent content blockers from blocking the icon -->
					<img src="/assets/footer/reddit_logo.svg" width="32" height="32" alt="Red​dit">
				</a>
				<a href="/rss.xml" target="_blank" rel="noopener">
					<!-- Icon is called `feed` instead of `rss` to prevent content blockers from blocking the icon -->
					<img src="/assets/footer/feed_logo.svg" width="32" height="32" alt="RSS feed">
				</a>
			</div>
		</div>
	</div>
</footer>

<script defer src="/assets/js/tobii.min.js"></script>
<script defer src="/assets/js/highlight.min.js?1"></script>
<script defer src="/assets/js/highlight.gdscript.min.js?1"></script>
<script>
	document.addEventListener('DOMContentLoaded', () => {
		// This needs to be done on page load but also after page changes,
		// in case a code block appears in an article.
		document.querySelectorAll('pre code').forEach((block) => {
			hljs.highlightBlock(block);
		});

		document.querySelectorAll('[data-post-date]').forEach((postDate) => {
			// Highlight post dates that are less than 48 hours old.
			if (Date.parse(postDate.dataset.postDate) > (Date.now() - 1000 * 60 * 60 * 48)) {
				postDate.classList.add("post-recent-highlight");
			};
		});

		// Initialize lightbox.
		new Tobii({
			zoom: false,
		});

		// Update any download link to point to identified user's OS.
		const links = document.querySelectorAll('.set-os-download-url');
		for (let i = 0; i < links.length; i++) {
			const link = links[i];
			let link_slug = 'download';
			if ('version' in link.dataset && link.dataset['version'] === '3') {
				link_slug = 'download/3.x';
			}

			let link_platform = 'windows';
			if (navigator.platform.indexOf('Mac') !== -1) {
				link_platform = 'macos';
			} else if (navigator.platform.indexOf('Linux') !== -1) {
				link_platform = 'linux';
			}

			link.href = `/${link_slug}/${link_platform}`;
		}
	});
</script>


</body>

</html>
